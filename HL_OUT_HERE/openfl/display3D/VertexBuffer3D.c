// Generated by HLC 4.3.1 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <openfl/display3D/VertexBuffer3D.h>
#include <lime/_internal/backend/native/NativeOpenGLRenderContext.h>
extern hl_type t$fun_1532d29;
vdynamic* openfl_display3D__Context3DBufferUsage_Context3DBufferUsage_Impl__fromString(String);
extern hl_type t$_i32;
extern hl_type t$fun_9a74d20;
#include <openfl/utils/ByteArrayData.h>
#include <haxe/io/Bytes.h>
#include <hl/types/ArrayDyn.h>
#include <lime/utils/TAError.h>
haxe__io__Bytes openfl_utils__ByteArray_ByteArray_Impl__toArrayBuffer(openfl__utils__ByteArrayData);
extern hl_type t$lime_utils_ArrayBufferView;
void lime_utils_ArrayBufferView_new(lime__utils__ArrayBufferView,vdynamic*,int);
int hl_types_ArrayDyn_get_length(hl__types__ArrayDyn);
haxe__io__Bytes haxe_io_Bytes_alloc(int);
void lime_utils_ArrayBufferView_copyFromArray(lime__utils__ArrayBufferView,hl__types__ArrayDyn,int*);
extern hl_type t$_dyn;
extern hl_type t$hl_types_ArrayDyn;
void haxe_io_Bytes_blit(haxe__io__Bytes,int,haxe__io__Bytes,int,int);
extern String s$unimplemented;
extern venum* g$lime_utils_TAError_RangeError;
extern String s$fdd939c;
void openfl_display3D_VertexBuffer3D_uploadFromTypedArray(openfl__display3D__VertexBuffer3D,lime__utils__ArrayBufferView,int*);
void openfl_display3D_Context3D___bindGLArrayBuffer(openfl__display3D__Context3D,lime__graphics__opengl__GLObject);
void lime_graphics__WebGLRenderContext_WebGLRenderContext_Impl__bufferData(lime___internal__backend__native__NativeOpenGLRenderContext,int,lime__utils__ArrayBufferView,int);
extern String s$53c6d62;
double openfl__Vector_FloatVector_get(openfl___Vector__FloatVector,int);
extern hl_type t$fun_06455fc;

void openfl_display3D_VertexBuffer3D_new(openfl__display3D__VertexBuffer3D r0,openfl__display3D__Context3D r1,int r2,int r3,String r4) {
	openfl__display3D__Context3D r5;
	lime___internal__backend__native__NativeOpenGLRenderContext r7;
	lime__graphics__opengl__GLObject r9;
	vclosure *r10;
	vdynamic *r12, *r13;
	int r6, r11;
	r0->__context = r1;
	r0->__numVertices = r2;
	r0->__vertexSize = r3;
	r5 = r0->__context;
	if( r5 == NULL ) hl_null_access();
	r7 = r5->gl;
	if( r7 == NULL ) hl_null_access();
	r10 = (vclosure*)hl_dyn_getp((vdynamic*)r7,-219546340/*createBuffer*/,&t$fun_1532d29);
	if( r10 == NULL ) hl_null_access();
	r9 = r10->hasValue ? ((lime__graphics__opengl__GLObject (*)(vdynamic*))r10->fun)((vdynamic*)r10->value) : ((lime__graphics__opengl__GLObject (*)(void))r10->fun)();
	r0->__id = r9;
	r6 = r0->__vertexSize;
	r11 = 4;
	r6 = r6 * r11;
	r0->__stride = r6;
	r12 = openfl_display3D__Context3DBufferUsage_Context3DBufferUsage_Impl__fromString(r4);
	r6 = 0;
	r13 = hl_alloc_dynamic(&t$_i32);
	r13->v.i = r6;
	if( r12 != r13 && (!r12 || !r13 || (r12->v.i != r13->v.i)) ) goto label$10ea0d3_1_21;
	r6 = r7->DYNAMIC_DRAW;
	goto label$10ea0d3_1_22;
	label$10ea0d3_1_21:
	r6 = r7->STATIC_DRAW;
	label$10ea0d3_1_22:
	r0->__usage = r6;
	return;
}

void openfl_display3D_VertexBuffer3D_dispose(openfl__display3D__VertexBuffer3D r0) {
	openfl__display3D__Context3D r2;
	lime___internal__backend__native__NativeOpenGLRenderContext r1;
	lime__graphics__opengl__GLObject r5;
	vclosure *r4;
	r2 = r0->__context;
	if( r2 == NULL ) hl_null_access();
	r1 = r2->gl;
	if( r1 == NULL ) hl_null_access();
	r4 = (vclosure*)hl_dyn_getp((vdynamic*)r1,388817936/*deleteBuffer*/,&t$fun_9a74d20);
	if( r4 == NULL ) hl_null_access();
	r5 = r0->__id;
	r4->hasValue ? ((void (*)(vdynamic*,lime__graphics__opengl__GLObject))r4->fun)((vdynamic*)r4->value,r5) : ((void (*)(lime__graphics__opengl__GLObject))r4->fun)(r5);
	return;
}

void openfl_display3D_VertexBuffer3D_uploadFromByteArray(openfl__display3D__VertexBuffer3D r0,openfl__utils__ByteArrayData r1,int r2,int r3,int r4) {
	String r28;
	venum *r29;
	haxe__io__Bytes r10, r19, r26;
	openfl___Vector__FloatVector r12;
	double r30, r31;
	lime__utils__ArrayBufferView r13, r16;
	hl__types__ArrayDyn r11, r17;
	int *r20;
	vdynamic *r9, *r14, *r15, *r21;
	int r5, r6, r7, r18, r22, r23, r24, r25, r27;
	r7 = r0->__stride;
	r6 = r3 * r7;
	r5 = r2 + r6;
	r7 = r0->__vertexSize;
	r6 = r4 * r7;
	r9 = NULL;
	r10 = openfl_utils__ByteArray_ByteArray_Impl__toArrayBuffer(r1);
	r11 = NULL;
	r12 = NULL;
	r13 = NULL;
	r14 = hl_alloc_dynamic(&t$_i32);
	r14->v.i = r5;
	if( r14 ) goto label$10ea0d3_3_15;
	r7 = 0;
	r15 = hl_alloc_dynamic(&t$_i32);
	r15->v.i = r7;
	r14 = r15;
	label$10ea0d3_3_15:
	if( !r9 ) goto label$10ea0d3_3_20;
	r16 = (lime__utils__ArrayBufferView)hl_alloc_obj(&t$lime_utils_ArrayBufferView);
	r7 = 8;
	lime_utils_ArrayBufferView_new(r16,r9,r7);
	goto label$10ea0d3_3_138;
	label$10ea0d3_3_20:
	if( !r11 ) goto label$10ea0d3_3_41;
	r16 = (lime__utils__ArrayBufferView)hl_alloc_obj(&t$lime_utils_ArrayBufferView);
	r7 = 0;
	r15 = hl_alloc_dynamic(&t$_i32);
	r15->v.i = r7;
	r7 = 8;
	lime_utils_ArrayBufferView_new(r16,r15,r7);
	r7 = 0;
	r16->byteOffset = r7;
	if( r11 == NULL ) hl_null_access();
	r7 = hl_types_ArrayDyn_get_length(r11);
	r16->length = r7;
	r7 = r16->length;
	r18 = r16->bytesPerElement;
	r7 = r7 * r18;
	r16->byteLength = r7;
	r7 = r16->byteLength;
	r19 = haxe_io_Bytes_alloc(r7);
	r16->buffer = r19;
	r20 = NULL;
	lime_utils_ArrayBufferView_copyFromArray(r16,r11,r20);
	goto label$10ea0d3_3_138;
	label$10ea0d3_3_41:
	if( !r12 ) goto label$10ea0d3_3_65;
	r16 = (lime__utils__ArrayBufferView)hl_alloc_obj(&t$lime_utils_ArrayBufferView);
	r7 = 0;
	r15 = hl_alloc_dynamic(&t$_i32);
	r15->v.i = r7;
	r7 = 8;
	lime_utils_ArrayBufferView_new(r16,r15,r7);
	if( r12 == NULL ) hl_null_access();
	r21 = (vdynamic*)hl_dyn_getp((vdynamic*)r12,-269630230/*__array*/,&t$_dyn);
	r17 = (hl__types__ArrayDyn)hl_dyn_castp(&r21,&t$_dyn,&t$hl_types_ArrayDyn);
	r7 = 0;
	r16->byteOffset = r7;
	if( r17 == NULL ) hl_null_access();
	r7 = hl_types_ArrayDyn_get_length(r17);
	r16->length = r7;
	r7 = r16->length;
	r18 = r16->bytesPerElement;
	r7 = r7 * r18;
	r16->byteLength = r7;
	r7 = r16->byteLength;
	r19 = haxe_io_Bytes_alloc(r7);
	r16->buffer = r19;
	r20 = NULL;
	lime_utils_ArrayBufferView_copyFromArray(r16,r17,r20);
	goto label$10ea0d3_3_138;
	label$10ea0d3_3_65:
	if( !r13 ) goto label$10ea0d3_3_99;
	r16 = (lime__utils__ArrayBufferView)hl_alloc_obj(&t$lime_utils_ArrayBufferView);
	r7 = 0;
	r15 = hl_alloc_dynamic(&t$_i32);
	r15->v.i = r7;
	r7 = 8;
	lime_utils_ArrayBufferView_new(r16,r15,r7);
	if( r13 == NULL ) hl_null_access();
	r19 = r13->buffer;
	r7 = r13->length;
	r18 = r13->byteOffset;
	r22 = r13->bytesPerElement;
	r23 = r16->bytesPerElement;
	r24 = r13->type;
	r25 = r16->type;
	if( r24 != r25 ) goto label$10ea0d3_3_90;
	if( r19 == NULL ) hl_null_access();
	r24 = r19->length;
	r25 = r24 - r18;
	r26 = haxe_io_Bytes_alloc(r25);
	r16->buffer = r26;
	r26 = r16->buffer;
	if( r26 == NULL ) hl_null_access();
	r27 = 0;
	haxe_io_Bytes_blit(r26,r27,r19,r18,r25);
	goto label$10ea0d3_3_92;
	label$10ea0d3_3_90:
	r28 = (String)s$unimplemented;
	hl_throw((vdynamic*)r28);
	label$10ea0d3_3_92:
	r24 = r16->bytesPerElement;
	r24 = r24 * r7;
	r16->byteLength = r24;
	r24 = 0;
	r16->byteOffset = r24;
	r16->length = r7;
	goto label$10ea0d3_3_138;
	label$10ea0d3_3_99:
	if( !r10 ) goto label$10ea0d3_3_136;
	r16 = (lime__utils__ArrayBufferView)hl_alloc_obj(&t$lime_utils_ArrayBufferView);
	r7 = 0;
	r15 = hl_alloc_dynamic(&t$_i32);
	r15->v.i = r7;
	r7 = 8;
	lime_utils_ArrayBufferView_new(r16,r15,r7);
	r7 = r14 ? r14->v.i : 0;
	r22 = 0;
	if( r7 >= r22 ) goto label$10ea0d3_3_110;
	r29 = (venum*)g$lime_utils_TAError_RangeError;
	hl_throw((vdynamic*)r29);
	label$10ea0d3_3_110:
	r22 = r16->bytesPerElement;
	r18 = r22 == 0 ? 0 : r7 % r22;
	r22 = 0;
	if( r18 == r22 ) goto label$10ea0d3_3_116;
	r29 = (venum*)g$lime_utils_TAError_RangeError;
	hl_throw((vdynamic*)r29);
	label$10ea0d3_3_116:
	if( r10 == NULL ) hl_null_access();
	r18 = r10->length;
	r22 = r16->bytesPerElement;
	r25 = r16->bytesPerElement;
	r24 = r6 * r25;
	r23 = r24;
	r24 = r7 + r23;
	if( r18 >= r24 ) goto label$10ea0d3_3_126;
	r29 = (venum*)g$lime_utils_TAError_RangeError;
	hl_throw((vdynamic*)r29);
	label$10ea0d3_3_126:
	r16->buffer = r10;
	r16->byteOffset = r7;
	r16->byteLength = r23;
	r30 = (double)r23;
	r24 = r16->bytesPerElement;
	r31 = (double)r24;
	r30 = r30 / r31;
	r24 = (int)r30;
	r16->length = r24;
	goto label$10ea0d3_3_138;
	label$10ea0d3_3_136:
	r28 = (String)s$fdd939c;
	hl_throw((vdynamic*)r28);
	label$10ea0d3_3_138:
	r20 = NULL;
	openfl_display3D_VertexBuffer3D_uploadFromTypedArray(r0,r16,r20);
	return;
}

void openfl_display3D_VertexBuffer3D_uploadFromTypedArray(openfl__display3D__VertexBuffer3D r0,lime__utils__ArrayBufferView r1,int* r2) {
	openfl__display3D__Context3D r6;
	lime___internal__backend__native__NativeOpenGLRenderContext r5;
	lime__graphics__opengl__GLObject r7;
	int r3, r8, r9;
	if( r2 ) goto label$10ea0d3_4_3;
	r3 = -1;
	goto label$10ea0d3_4_4;
	label$10ea0d3_4_3:
	r3 = *r2;
	label$10ea0d3_4_4:
	if( r1 ) goto label$10ea0d3_4_6;
	return;
	label$10ea0d3_4_6:
	r6 = r0->__context;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->gl;
	r6 = r0->__context;
	if( r6 == NULL ) hl_null_access();
	r7 = r0->__id;
	openfl_display3D_Context3D___bindGLArrayBuffer(r6,r7);
	if( r5 == NULL ) hl_null_access();
	r8 = r5->ARRAY_BUFFER;
	r9 = r0->__usage;
	lime_graphics__WebGLRenderContext_WebGLRenderContext_Impl__bufferData(r5,r8,r1,r9);
	return;
}

void openfl_display3D_VertexBuffer3D_uploadFromVector(openfl__display3D__VertexBuffer3D r0,openfl___Vector__FloatVector r1,int r2,int r3) {
	String r29;
	openfl__display3D__Context3D r7;
	haxe__io__Bytes r15, r21, r27;
	lime___internal__backend__native__NativeOpenGLRenderContext r6;
	openfl___Vector__FloatVector r5;
	vclosure *r31;
	double r30;
	hl__types__ArrayDyn r16, r20;
	lime__utils__ArrayBufferView r12, r13, r18;
	int *r22;
	vdynamic *r17, *r19;
	int r8, r9, r10, r11, r14, r23, r24, r25, r26, r28;
	if( r1 ) goto label$10ea0d3_5_2;
	return;
	label$10ea0d3_5_2:
	r7 = r0->__context;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->gl;
	r9 = r0->__vertexSize;
	r8 = r2 * r9;
	r10 = r0->__vertexSize;
	r9 = r3 * r10;
	r10 = r8 + r9;
	r12 = r0->__tempFloat32Array;
	r13 = r0->__tempFloat32Array;
	if( !r13 ) goto label$10ea0d3_5_17;
	r13 = r0->__tempFloat32Array;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->length;
	if( r11 >= r9 ) goto label$10ea0d3_5_53;
	label$10ea0d3_5_17:
	r15 = NULL;
	r16 = NULL;
	r5 = NULL;
	r13 = NULL;
	r17 = NULL;
	r18 = (lime__utils__ArrayBufferView)hl_alloc_obj(&t$lime_utils_ArrayBufferView);
	r19 = hl_alloc_dynamic(&t$_i32);
	r19->v.i = r9;
	r11 = 8;
	lime_utils_ArrayBufferView_new(r18,r19,r11);
	r0->__tempFloat32Array = r18;
	if( !r12 ) goto label$10ea0d3_5_53;
	r18 = r0->__tempFloat32Array;
	r20 = NULL;
	r11 = 0;
	if( !r12 ) goto label$10ea0d3_5_44;
	if( r20 ) goto label$10ea0d3_5_44;
	if( r18 == NULL ) hl_null_access();
	r21 = r18->buffer;
	if( r21 == NULL ) hl_null_access();
	r23 = r18->bytesPerElement;
	r14 = r11 * r23;
	if( r12 == NULL ) hl_null_access();
	r27 = r12->buffer;
	r23 = r12->byteOffset;
	r24 = r12->byteLength;
	haxe_io_Bytes_blit(r21,r14,r27,r23,r24);
	goto label$10ea0d3_5_53;
	label$10ea0d3_5_44:
	if( !r20 ) goto label$10ea0d3_5_51;
	if( r12 ) goto label$10ea0d3_5_51;
	if( r18 == NULL ) hl_null_access();
	r14 = r11;
	r22 = &r14;
	lime_utils_ArrayBufferView_copyFromArray(r18,r20,r22);
	goto label$10ea0d3_5_53;
	label$10ea0d3_5_51:
	r29 = (String)s$53c6d62;
	hl_throw((vdynamic*)r29);
	label$10ea0d3_5_53:
	r11 = r8;
	r23 = r10;
	label$10ea0d3_5_55:
	if( r11 >= r23 ) goto label$10ea0d3_5_74;
	r24 = r11;
	++r11;
	r13 = r0->__tempFloat32Array;
	if( r1 == NULL ) hl_null_access();
	r30 = openfl__Vector_FloatVector_get(r1,r24);
	if( r13 == NULL ) hl_null_access();
	r15 = r13->buffer;
	if( r15 == NULL ) hl_null_access();
	r31 = (vclosure*)hl_dyn_getp((vdynamic*)r15,281751194/*setFloat*/,&t$fun_06455fc);
	if( r31 == NULL ) hl_null_access();
	r25 = r13->byteOffset;
	r26 = r24 - r8;
	r28 = 4;
	r26 = r26 * r28;
	r25 = r25 + r26;
	r31->hasValue ? ((void (*)(vdynamic*,int,double))r31->fun)((vdynamic*)r31->value,r25,r30) : ((void (*)(int,double))r31->fun)(r25,r30);
	goto label$10ea0d3_5_55;
	label$10ea0d3_5_74:
	r13 = r0->__tempFloat32Array;
	r22 = NULL;
	openfl_display3D_VertexBuffer3D_uploadFromTypedArray(r0,r13,r22);
	return;
}

