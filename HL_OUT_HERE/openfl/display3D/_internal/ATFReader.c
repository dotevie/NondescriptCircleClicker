// Generated by HLC 4.3.1 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <openfl/display3D/_internal/ATFReader.h>
#include <openfl/errors/IllegalOperationError.h>
#include <hl/types/ArrayDyn.h>
int openfl_utils_ByteArrayData_readUnsignedByte(openfl__utils__ByteArrayData);
extern hl_type t$openfl_errors_IllegalOperationError;
extern String s$ATF_Cube_map_not_expected;
void openfl_errors_IllegalOperationError_new(openfl__errors__IllegalOperationError,String);
extern String s$ATF_Cube_map_expected;
extern String s$7f44fb9;
extern hl_type t$vrt_329ffa8;
extern String s$60debcf;
extern hl_type t$String;
extern hl_type t$_i32;
extern String s$0364408;
extern String s$readHeader;
extern hl_type t$vrt_eaa6a3b;
void lime_utils_Log_warn(vdynamic*,vvirtual*);
extern String s$ATF_width_and_height_dont_match;
#include <haxe/io/Bytes.h>
int openfl_display3D__internal_ATFReader___readUInt24(openfl__display3D___internal__ATFReader,openfl__utils__ByteArrayData);
int openfl_display3D__internal_ATFReader___readUInt32(openfl__display3D___internal__ATFReader,openfl__utils__ByteArrayData);
int openfl_utils__ByteArray_ByteArray_Impl__get_length(openfl__utils__ByteArrayData);
extern String s$90b681d;
haxe__io__Bytes haxe_io_Bytes_alloc(int);
openfl__utils__ByteArrayData openfl_utils__ByteArray_ByteArray_Impl__fromBytes(haxe__io__Bytes);
void openfl_utils_ByteArrayData_readBytes(openfl__utils__ByteArrayData,openfl__utils__ByteArrayData,int*,int*);
String openfl_utils_ByteArrayData_readUTFBytes(openfl__utils__ByteArrayData,int);
extern String s$ATF;
int String___compare(String,vdynamic*);
extern String s$ATF_signature_not_found;
int haxe_io_Bytes_get(haxe__io__Bytes,int);
extern String s$3f104af;

bool openfl_display3D__internal_ATFReader_readHeader(openfl__display3D___internal__ATFReader r0,int r1,int r2,bool r3) {
	String r12, r14;
	vvirtual *r13, *r15;
	bool r9;
	openfl__utils__ByteArrayData r5;
	openfl__errors__IllegalOperationError r11;
	int r4, r7, r8, r10;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r4 = openfl_utils_ByteArrayData_readUnsignedByte(r5);
	r8 = 7;
	r7 = ((unsigned)r4) >> r8;
	if( r3 ) goto label$e71c71c_1_12;
	r10 = 0;
	if( r7 == r10 ) goto label$e71c71c_1_12;
	r11 = (openfl__errors__IllegalOperationError)hl_alloc_obj(&t$openfl_errors_IllegalOperationError);
	r12 = (String)s$ATF_Cube_map_not_expected;
	openfl_errors_IllegalOperationError_new(r11,r12);
	hl_throw((vdynamic*)r11);
	label$e71c71c_1_12:
	if( !r3 ) goto label$e71c71c_1_19;
	r10 = 1;
	if( r7 == r10 ) goto label$e71c71c_1_19;
	r11 = (openfl__errors__IllegalOperationError)hl_alloc_obj(&t$openfl_errors_IllegalOperationError);
	r12 = (String)s$ATF_Cube_map_expected;
	openfl_errors_IllegalOperationError_new(r11,r12);
	hl_throw((vdynamic*)r11);
	label$e71c71c_1_19:
	r0->cubeMap = r3;
	r10 = 127;
	r8 = r4 & r10;
	r0->atfFormat = r8;
	r8 = r0->atfFormat;
	r10 = 3;
	if( r8 == r10 ) goto label$e71c71c_1_41;
	r8 = r0->atfFormat;
	r10 = 5;
	if( r8 == r10 ) goto label$e71c71c_1_41;
	r12 = (String)s$7f44fb9;
	r13 = hl_alloc_virtual(&t$vrt_329ffa8);
	r14 = (String)s$60debcf;
	if( hl_vfields(r13)[1] ) *(String*)(hl_vfields(r13)[1]) = (String)r14; else hl_dyn_setp(r13->value,37969014/*fileName*/,&t$String,r14);
	r8 = 96;
	if( hl_vfields(r13)[2] ) *(int*)(hl_vfields(r13)[2]) = (int)r8; else hl_dyn_seti(r13->value,371360620/*lineNumber*/,&t$_i32,r8);
	r14 = (String)s$0364408;
	if( hl_vfields(r13)[0] ) *(String*)(hl_vfields(r13)[0]) = (String)r14; else hl_dyn_setp(r13->value,-63073762/*className*/,&t$String,r14);
	r14 = (String)s$readHeader;
	if( hl_vfields(r13)[3] ) *(String*)(hl_vfields(r13)[3]) = (String)r14; else hl_dyn_setp(r13->value,302979532/*methodName*/,&t$String,r14);
	r15 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r13);
	lime_utils_Log_warn(((vdynamic*)r12),r15);
	label$e71c71c_1_41:
	r8 = 1;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r10 = openfl_utils_ByteArrayData_readUnsignedByte(r5);
	r8 = r8 << r10;
	r0->width = r8;
	r8 = 1;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r10 = openfl_utils_ByteArrayData_readUnsignedByte(r5);
	r8 = r8 << r10;
	r0->height = r8;
	r8 = r0->width;
	if( r8 != r1 ) goto label$e71c71c_1_57;
	r8 = r0->height;
	if( r8 == r2 ) goto label$e71c71c_1_61;
	label$e71c71c_1_57:
	r11 = (openfl__errors__IllegalOperationError)hl_alloc_obj(&t$openfl_errors_IllegalOperationError);
	r12 = (String)s$ATF_width_and_height_dont_match;
	openfl_errors_IllegalOperationError_new(r11,r12);
	hl_throw((vdynamic*)r11);
	label$e71c71c_1_61:
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r8 = openfl_utils_ByteArrayData_readUnsignedByte(r5);
	r0->mipCount = r8;
	r8 = r0->atfFormat;
	r10 = 5;
	if( r8 == r10 ) goto label$e71c71c_1_70;
	r9 = false;
	goto label$e71c71c_1_71;
	label$e71c71c_1_70:
	r9 = true;
	label$e71c71c_1_71:
	return r9;
}

void openfl_display3D__internal_ATFReader_readTextures(openfl__display3D___internal__ATFReader r0,vclosure* r1) {
	String r20;
	haxe__io__Bytes r21;
	openfl__utils__ByteArrayData r17, r22;
	bool r5;
	openfl__errors__IllegalOperationError r19;
	int *r23, *r24;
	int r2, r3, r6, r7, r8, r9, r10, r11, r12, r13, r14, r15, r16, r18, r25, r26;
	r2 = r0->version;
	r3 = 3;
	if( r2 >= r3 ) goto label$e71c71c_2_5;
	r2 = 3;
	goto label$e71c71c_2_6;
	label$e71c71c_2_5:
	r2 = 4;
	label$e71c71c_2_6:
	r5 = r0->cubeMap;
	if( !r5 ) goto label$e71c71c_2_10;
	r3 = 6;
	goto label$e71c71c_2_11;
	label$e71c71c_2_10:
	r3 = 1;
	label$e71c71c_2_11:
	r6 = 0;
	r7 = r3;
	label$e71c71c_2_13:
	if( r6 >= r7 ) goto label$e71c71c_2_68;
	r8 = r6;
	++r6;
	r9 = 0;
	r10 = r0->mipCount;
	label$e71c71c_2_19:
	if( r9 >= r10 ) goto label$e71c71c_2_67;
	r11 = r9;
	++r9;
	r12 = 0;
	r13 = r2;
	label$e71c71c_2_25:
	if( r12 >= r13 ) goto label$e71c71c_2_66;
	r14 = r12;
	++r12;
	r15 = r0->version;
	r16 = 0;
	if( r15 != r16 ) goto label$e71c71c_2_35;
	r17 = r0->data;
	r15 = openfl_display3D__internal_ATFReader___readUInt24(r0,r17);
	goto label$e71c71c_2_37;
	label$e71c71c_2_35:
	r17 = r0->data;
	r15 = openfl_display3D__internal_ATFReader___readUInt32(r0,r17);
	label$e71c71c_2_37:
	r17 = r0->data;
	if( r17 == NULL ) hl_null_access();
	r16 = r17->position;
	r16 = r16 + r15;
	r17 = r0->data;
	r18 = openfl_utils__ByteArray_ByteArray_Impl__get_length(r17);
	if( ((unsigned)r18) >= ((unsigned)r16) ) goto label$e71c71c_2_48;
	r19 = (openfl__errors__IllegalOperationError)hl_alloc_obj(&t$openfl_errors_IllegalOperationError);
	r20 = (String)s$90b681d;
	openfl_errors_IllegalOperationError_new(r19,r20);
	hl_throw((vdynamic*)r19);
	label$e71c71c_2_48:
	r18 = 0;
	if( ((unsigned)r18) >= ((unsigned)r15) ) goto label$e71c71c_2_65;
	r21 = haxe_io_Bytes_alloc(r15);
	r17 = r0->data;
	if( r17 == NULL ) hl_null_access();
	r22 = openfl_utils__ByteArray_ByteArray_Impl__fromBytes(r21);
	r16 = 0;
	r23 = &r16;
	r18 = r15;
	r24 = &r18;
	openfl_utils_ByteArrayData_readBytes(r17,r22,r23,r24);
	if( r1 == NULL ) hl_null_access();
	r25 = r0->width;
	r25 = r25 >> r11;
	r26 = r0->height;
	r26 = r26 >> r11;
	r1->hasValue ? ((void (*)(vdynamic*,int,int,int,int,int,int,haxe__io__Bytes))r1->fun)((vdynamic*)r1->value,r8,r11,r14,r25,r26,r15,r21) : ((void (*)(int,int,int,int,int,int,haxe__io__Bytes))r1->fun)(r8,r11,r14,r25,r26,r15,r21);
	label$e71c71c_2_65:
	goto label$e71c71c_2_25;
	label$e71c71c_2_66:
	goto label$e71c71c_2_19;
	label$e71c71c_2_67:
	goto label$e71c71c_2_13;
	label$e71c71c_2_68:
	return;
}

int openfl_display3D__internal_ATFReader___readUInt24(openfl__display3D___internal__ATFReader r0,openfl__utils__ByteArrayData r1) {
	int r2, r3, r4, r5;
	if( r1 == NULL ) hl_null_access();
	r2 = openfl_utils_ByteArrayData_readUnsignedByte(r1);
	r3 = 16;
	r2 = r2 << r3;
	r4 = openfl_utils_ByteArrayData_readUnsignedByte(r1);
	r5 = 8;
	r4 = r4 << r5;
	r3 = r2 | r4;
	r4 = openfl_utils_ByteArrayData_readUnsignedByte(r1);
	r3 = r3 | r4;
	return r3;
}

int openfl_display3D__internal_ATFReader___readUInt32(openfl__display3D___internal__ATFReader r0,openfl__utils__ByteArrayData r1) {
	int r2, r3, r4, r5;
	if( r1 == NULL ) hl_null_access();
	r2 = openfl_utils_ByteArrayData_readUnsignedByte(r1);
	r3 = 24;
	r2 = r2 << r3;
	r4 = openfl_utils_ByteArrayData_readUnsignedByte(r1);
	r5 = 16;
	r4 = r4 << r5;
	r3 = r2 | r4;
	r4 = openfl_utils_ByteArrayData_readUnsignedByte(r1);
	r5 = 8;
	r4 = r4 << r5;
	r3 = r3 | r4;
	r4 = openfl_utils_ByteArrayData_readUnsignedByte(r1);
	r3 = r3 | r4;
	return r3;
}

void openfl_display3D__internal_ATFReader_new(openfl__display3D___internal__ATFReader r0,openfl__utils__ByteArrayData r1,int r2) {
	String r4, r6, r7;
	openfl__errors__IllegalOperationError r8;
	int r3, r9, r10;
	r3 = 0;
	r0->version = r3;
	if( r1 == NULL ) hl_null_access();
	r1->position = r2;
	r3 = 3;
	r4 = openfl_utils_ByteArrayData_readUTFBytes(r1,r3);
	r1->position = r2;
	r7 = (String)s$ATF;
	if( r4 == r7 || (r4 && r7 && String___compare(r4,(vdynamic*)r7) == 0) ) goto label$e71c71c_5_13;
	r8 = (openfl__errors__IllegalOperationError)hl_alloc_obj(&t$openfl_errors_IllegalOperationError);
	r6 = (String)s$ATF_signature_not_found;
	openfl_errors_IllegalOperationError_new(r8,r6);
	hl_throw((vdynamic*)r8);
	label$e71c71c_5_13:
	r3 = 0;
	r10 = 6;
	r9 = r2 + r10;
	r9 = haxe_io_Bytes_get(((haxe__io__Bytes)r1),r9);
	r10 = 255;
	if( r9 != r10 ) goto label$e71c71c_5_29;
	r10 = 7;
	r9 = r2 + r10;
	r9 = haxe_io_Bytes_get(((haxe__io__Bytes)r1),r9);
	r0->version = r9;
	r10 = 8;
	r9 = r2 + r10;
	r1->position = r9;
	r9 = openfl_display3D__internal_ATFReader___readUInt32(r0,r1);
	r3 = r9;
	goto label$e71c71c_5_36;
	label$e71c71c_5_29:
	r9 = 0;
	r0->version = r9;
	r10 = 3;
	r9 = r2 + r10;
	r1->position = r9;
	r9 = openfl_display3D__internal_ATFReader___readUInt24(r0,r1);
	r3 = r9;
	label$e71c71c_5_36:
	r9 = r2 + r3;
	r10 = openfl_utils__ByteArray_ByteArray_Impl__get_length(r1);
	if( r10 >= r9 ) goto label$e71c71c_5_43;
	r8 = (openfl__errors__IllegalOperationError)hl_alloc_obj(&t$openfl_errors_IllegalOperationError);
	r6 = (String)s$3f104af;
	openfl_errors_IllegalOperationError_new(r8,r6);
	hl_throw((vdynamic*)r8);
	label$e71c71c_5_43:
	r0->data = r1;
	return;
}

