// Generated by HLC 4.3.1 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <lime/net/_HTTPRequest_String.h>
void lime_net__HTTPRequest_AbstractHTTPRequest_new(lime__net___HTTPRequest__AbstractHTTPRequest,String);
lime__app__Promise lime_app_Promise_complete(lime__app__Promise,vdynamic*);
#include <lime/app/Future.h>
extern hl_type t$lime_app_Promise;
void lime_app_Promise_new(lime__app__Promise);
lime__app__Future lime__internal_backend_native_NativeHTTPRequest_loadText(lime___internal__backend__native__NativeHTTPRequest,String);
lime__app__Promise lime_app_Promise_progress(lime__app__Promise,int,int);
extern hl_type t$fun_a4fdf42;
void wrapt$fun_354f561(vclosure*,int,int);
extern hl_type t$fun_354f561;
lime__app__Future lime_app_Future_onProgress(lime__app__Future,vclosure*);
lime__app__Promise lime_app_Promise_error(lime__app__Promise,vdynamic*);
extern hl_type t$fun_2b2a2eb;
void wrapt$fun_e2ed85b(vclosure*,vdynamic*);
extern hl_type t$fun_e2ed85b;
lime__app__Future lime_app_Future_onError(lime__app__Future,vclosure*);
extern hl_type t$ctx_c809d1f;
extern hl_type t$fun_2310514;
void wrapt$fun_c8bb61c(vclosure*,vdynamic*);
extern hl_type t$fun_c8bb61c;
lime__app__Future lime_app_Future_onComplete(lime__app__Future,vclosure*);

void lime_net__HTTPRequest_String_new(lime__net___HTTPRequest_String r0,String r1) {
	lime_net__HTTPRequest_AbstractHTTPRequest_new(((lime__net___HTTPRequest__AbstractHTTPRequest)r0),r1);
	return;
}

void lime_net__HTTPRequest_String_load__$1(venum* r0,String r1) {
	lime__net___HTTPRequest_String r2;
	lime__app__Promise r3;
	vdynamic *r4;
	r2 = ((Enumt$ctx_c809d1f*)r0)->p1;
	if( r2 == NULL ) hl_null_access();
	r2->responseData = ((vdynamic*)r1);
	r3 = ((Enumt$ctx_c809d1f*)r0)->p0;
	if( r3 == NULL ) hl_null_access();
	r2 = ((Enumt$ctx_c809d1f*)r0)->p1;
	if( r2 == NULL ) hl_null_access();
	r4 = r2->responseData;
	r3 = lime_app_Promise_complete(r3,r4);
	return;
}

lime__app__Future lime_net__HTTPRequest_String_load(lime__net___HTTPRequest_String r0,String r1) {
	String r3;
	venum *r13;
	lime__app__Future r5, r7;
	lime___internal__backend__native__NativeHTTPRequest r6;
	lime__app__Promise r4;
	vclosure *r8, *r9, *r10, *r11, *r12;
	if( !r1 ) goto label$c162b11_3_2;
	r0->uri = r1;
	label$c162b11_3_2:
	r4 = (lime__app__Promise)hl_alloc_obj(&t$lime_app_Promise);
	lime_app_Promise_new(r4);
	r6 = r0->__backend;
	if( r6 == NULL ) hl_null_access();
	r3 = r0->uri;
	r5 = lime__internal_backend_native_NativeHTTPRequest_loadText(r6,r3);
	if( r5 == NULL ) hl_null_access();
	r8 = hl_alloc_closure_ptr(&t$fun_a4fdf42,lime_app_Promise_progress,r4);
	if( r8 ) goto label$c162b11_3_13;
	r9 = NULL;
	goto label$c162b11_3_14;
	label$c162b11_3_13:
	r9 = hl_alloc_closure_ptr(&t$fun_354f561,wrapt$fun_354f561,r8);
	label$c162b11_3_14:
	r7 = lime_app_Future_onProgress(r5,r9);
	r10 = hl_alloc_closure_ptr(&t$fun_2b2a2eb,lime_app_Promise_error,r4);
	if( r10 ) goto label$c162b11_3_19;
	r11 = NULL;
	goto label$c162b11_3_20;
	label$c162b11_3_19:
	r11 = hl_alloc_closure_ptr(&t$fun_e2ed85b,wrapt$fun_e2ed85b,r10);
	label$c162b11_3_20:
	r7 = lime_app_Future_onError(r5,r11);
	r13 = hl_alloc_enum(&t$ctx_c809d1f,0);
	((Enumt$ctx_c809d1f*)r13)->p0 = (lime__app__Promise)r4;
	((Enumt$ctx_c809d1f*)r13)->p1 = (lime__net___HTTPRequest_String)r0;
	r12 = hl_alloc_closure_ptr(&t$fun_2310514,lime_net__HTTPRequest_String_load__$1,r13);
	if( r12 ) goto label$c162b11_3_28;
	r11 = NULL;
	goto label$c162b11_3_29;
	label$c162b11_3_28:
	r11 = hl_alloc_closure_ptr(&t$fun_c8bb61c,wrapt$fun_c8bb61c,r12);
	label$c162b11_3_29:
	r7 = lime_app_Future_onComplete(r5,r11);
	r7 = r4->future;
	return r7;
}

