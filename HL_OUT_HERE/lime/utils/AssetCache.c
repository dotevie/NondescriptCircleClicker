// Generated by HLC 4.3.1 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <lime/utils/AssetCache.h>
extern String s$IMAGE;
int String___compare(String,vdynamic*);
bool haxe_ds_StringMap_exists(haxe__ds__StringMap,String);
extern String s$FONT;
extern String s$SOUND;
extern String s$MUSIC;
#include <lime/graphics/Image.h>
#include <lime/media/AudioBuffer.h>
#include <hl/natives.h>
extern String s$_assets_are_not_cachable;
String String___add__(String,String);
void haxe_ds_StringMap_set(haxe__ds__StringMap,String,vdynamic*);
extern lime__graphics__$Image g$_lime_graphics_Image;
bool Std_isOfType(vdynamic*,vdynamic*);
extern String s$Cannot_cache_non_Image_asset_;
String Std_string(vdynamic*);
extern String s$_as_Image;
extern hl_type t$lime_graphics_Image;
extern hl_type t$_dyn;
extern lime__media__$AudioBuffer g$_lime_media_AudioBuffer;
extern String s$42e286a;
extern String s$_as_AudioBuffer;
extern hl_type t$lime_media_AudioBuffer;
extern hl_type t$haxe_ds_StringMap;
void haxe_ds_StringMap_new(haxe__ds__StringMap);
vvirtual* haxe_ds_StringMap_keys(haxe__ds__StringMap);
extern hl_type t$fun_bf7849e;
extern hl_type t$fun_820f49a;
bool StringTools_startsWith(String,String);
bool haxe_ds_StringMap_remove(haxe__ds__StringMap,String);

bool lime_utils_AssetCache_exists(lime__utils__AssetCache r0,String r1,String r2) {
	String r3;
	haxe__ds__StringMap r5;
	bool r4;
	r3 = (String)s$IMAGE;
	if( r2 == r3 || (r2 && r3 && String___compare(r2,(vdynamic*)r3) == 0) ) goto label$e6f3e81_1_3;
	if( r2 ) goto label$e6f3e81_1_9;
	label$e6f3e81_1_3:
	r5 = r0->image;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_exists(r5,r1);
	if( !r4 ) goto label$e6f3e81_1_9;
	r4 = true;
	return r4;
	label$e6f3e81_1_9:
	r3 = (String)s$FONT;
	if( r2 == r3 || (r2 && r3 && String___compare(r2,(vdynamic*)r3) == 0) ) goto label$e6f3e81_1_12;
	if( r2 ) goto label$e6f3e81_1_18;
	label$e6f3e81_1_12:
	r5 = r0->font;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_exists(r5,r1);
	if( !r4 ) goto label$e6f3e81_1_18;
	r4 = true;
	return r4;
	label$e6f3e81_1_18:
	r3 = (String)s$SOUND;
	if( r2 == r3 || (r2 && r3 && String___compare(r2,(vdynamic*)r3) == 0) ) goto label$e6f3e81_1_23;
	r3 = (String)s$MUSIC;
	if( r2 == r3 || (r2 && r3 && String___compare(r2,(vdynamic*)r3) == 0) ) goto label$e6f3e81_1_23;
	if( r2 ) goto label$e6f3e81_1_29;
	label$e6f3e81_1_23:
	r5 = r0->audio;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_exists(r5,r1);
	if( !r4 ) goto label$e6f3e81_1_29;
	r4 = true;
	return r4;
	label$e6f3e81_1_29:
	r4 = false;
	return r4;
}

void lime_utils_AssetCache_set(lime__utils__AssetCache r0,String r1,String r2,vdynamic* r3) {
	lime__graphics__Image r14;
	String r5, r10;
	lime__media__AudioBuffer r16;
	haxe__ds__StringMap r11;
	bool r12;
	lime__graphics__$Image r13;
	lime__media__$AudioBuffer r15;
	vbyte *r8, *r9;
	int r6, r7;
	if( !r2 ) goto label$e6f3e81_2_9;
	r6 = r2->length;
	r7 = 4;
	if( r6 != r7 ) goto label$e6f3e81_2_9;
	r8 = r2->bytes;
	r9 = (vbyte*)USTR("FONT");
	r6 = hl_string_compare(r8,r9,r6);
	r7 = 0;
	if( r6 == r7 ) goto label$e6f3e81_2_39;
	label$e6f3e81_2_9:
	if( !r2 ) goto label$e6f3e81_2_18;
	r6 = r2->length;
	r7 = 5;
	if( r6 != r7 ) goto label$e6f3e81_2_18;
	r8 = r2->bytes;
	r9 = (vbyte*)USTR("IMAGE");
	r6 = hl_string_compare(r8,r9,r6);
	r7 = 0;
	if( r6 == r7 ) goto label$e6f3e81_2_43;
	label$e6f3e81_2_18:
	if( !r2 ) goto label$e6f3e81_2_27;
	r6 = r2->length;
	r7 = 5;
	if( r6 != r7 ) goto label$e6f3e81_2_27;
	r8 = r2->bytes;
	r9 = (vbyte*)USTR("MUSIC");
	r6 = hl_string_compare(r8,r9,r6);
	r7 = 0;
	if( r6 == r7 ) goto label$e6f3e81_2_57;
	label$e6f3e81_2_27:
	if( !r2 ) goto label$e6f3e81_2_36;
	r6 = r2->length;
	r7 = 5;
	if( r6 != r7 ) goto label$e6f3e81_2_36;
	r8 = r2->bytes;
	r9 = (vbyte*)USTR("SOUND");
	r6 = hl_string_compare(r8,r9,r6);
	r7 = 0;
	if( r6 == r7 ) goto label$e6f3e81_2_57;
	label$e6f3e81_2_36:
	r10 = (String)s$_assets_are_not_cachable;
	r5 = String___add__(r2,r10);
	hl_throw((vdynamic*)r5);
	label$e6f3e81_2_39:
	r11 = r0->font;
	if( r11 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r11,r1,r3);
	goto label$e6f3e81_2_70;
	label$e6f3e81_2_43:
	r13 = (lime__graphics__$Image)g$_lime_graphics_Image;
	r12 = Std_isOfType(r3,((vdynamic*)r13));
	if( r12 ) goto label$e6f3e81_2_52;
	r5 = (String)s$Cannot_cache_non_Image_asset_;
	r10 = Std_string(r3);
	r5 = String___add__(r5,r10);
	r10 = (String)s$_as_Image;
	r5 = String___add__(r5,r10);
	hl_throw((vdynamic*)r5);
	label$e6f3e81_2_52:
	r11 = r0->image;
	if( r11 == NULL ) hl_null_access();
	r14 = (lime__graphics__Image)hl_dyn_castp(&r3,&t$_dyn,&t$lime_graphics_Image);
	haxe_ds_StringMap_set(r11,r1,((vdynamic*)r14));
	goto label$e6f3e81_2_70;
	label$e6f3e81_2_57:
	r15 = (lime__media__$AudioBuffer)g$_lime_media_AudioBuffer;
	r12 = Std_isOfType(r3,((vdynamic*)r15));
	if( r12 ) goto label$e6f3e81_2_66;
	r5 = (String)s$42e286a;
	r10 = Std_string(r3);
	r5 = String___add__(r5,r10);
	r10 = (String)s$_as_AudioBuffer;
	r5 = String___add__(r5,r10);
	hl_throw((vdynamic*)r5);
	label$e6f3e81_2_66:
	r11 = r0->audio;
	if( r11 == NULL ) hl_null_access();
	r16 = (lime__media__AudioBuffer)hl_dyn_castp(&r3,&t$_dyn,&t$lime_media_AudioBuffer);
	haxe_ds_StringMap_set(r11,r1,((vdynamic*)r16));
	label$e6f3e81_2_70:
	return;
}

void lime_utils_AssetCache_clear(lime__utils__AssetCache r0,String r1) {
	String r3;
	vvirtual *r5, *r6, *r8, *r9;
	haxe__ds__StringMap r4;
	bool r7;
	if( r1 ) goto label$e6f3e81_3_11;
	r4 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r4);
	r0->audio = r4;
	r4 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r4);
	r0->font = r4;
	r4 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r4);
	r0->image = r4;
	goto label$e6f3e81_3_56;
	label$e6f3e81_3_11:
	r4 = r0->audio;
	if( r4 == NULL ) hl_null_access();
	r5 = haxe_ds_StringMap_keys(r4);
	r6 = r5;
	label$e6f3e81_3_15:
	if( r6 == NULL ) hl_null_access();
	if( hl_vfields(r6)[0] ) r7 = ((bool (*)(vdynamic*))hl_vfields(r6)[0])(r6->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r6->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r7 = (bool)ret.v.i;
	}
	if( !r7 ) goto label$e6f3e81_3_26;
	if( hl_vfields(r6)[1] ) r3 = ((String (*)(vdynamic*))hl_vfields(r6)[1])(r6->value); else {
		r3 = (String)hl_dyn_call_obj(r6->value,&t$fun_820f49a,151160317/*next*/,NULL,NULL);
	}
	r7 = StringTools_startsWith(r3,r1);
	if( !r7 ) goto label$e6f3e81_3_25;
	r4 = r0->audio;
	if( r4 == NULL ) hl_null_access();
	r7 = haxe_ds_StringMap_remove(r4,r3);
	label$e6f3e81_3_25:
	goto label$e6f3e81_3_15;
	label$e6f3e81_3_26:
	r4 = r0->font;
	if( r4 == NULL ) hl_null_access();
	r6 = haxe_ds_StringMap_keys(r4);
	r8 = r6;
	label$e6f3e81_3_30:
	if( r8 == NULL ) hl_null_access();
	if( hl_vfields(r8)[0] ) r7 = ((bool (*)(vdynamic*))hl_vfields(r8)[0])(r8->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r8->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r7 = (bool)ret.v.i;
	}
	if( !r7 ) goto label$e6f3e81_3_41;
	if( hl_vfields(r8)[1] ) r3 = ((String (*)(vdynamic*))hl_vfields(r8)[1])(r8->value); else {
		r3 = (String)hl_dyn_call_obj(r8->value,&t$fun_820f49a,151160317/*next*/,NULL,NULL);
	}
	r7 = StringTools_startsWith(r3,r1);
	if( !r7 ) goto label$e6f3e81_3_40;
	r4 = r0->font;
	if( r4 == NULL ) hl_null_access();
	r7 = haxe_ds_StringMap_remove(r4,r3);
	label$e6f3e81_3_40:
	goto label$e6f3e81_3_30;
	label$e6f3e81_3_41:
	r4 = r0->image;
	if( r4 == NULL ) hl_null_access();
	r8 = haxe_ds_StringMap_keys(r4);
	r9 = r8;
	label$e6f3e81_3_45:
	if( r9 == NULL ) hl_null_access();
	if( hl_vfields(r9)[0] ) r7 = ((bool (*)(vdynamic*))hl_vfields(r9)[0])(r9->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r9->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r7 = (bool)ret.v.i;
	}
	if( !r7 ) goto label$e6f3e81_3_56;
	if( hl_vfields(r9)[1] ) r3 = ((String (*)(vdynamic*))hl_vfields(r9)[1])(r9->value); else {
		r3 = (String)hl_dyn_call_obj(r9->value,&t$fun_820f49a,151160317/*next*/,NULL,NULL);
	}
	r7 = StringTools_startsWith(r3,r1);
	if( !r7 ) goto label$e6f3e81_3_55;
	r4 = r0->image;
	if( r4 == NULL ) hl_null_access();
	r7 = haxe_ds_StringMap_remove(r4,r3);
	label$e6f3e81_3_55:
	goto label$e6f3e81_3_45;
	label$e6f3e81_3_56:
	return;
}

void lime_utils_AssetCache_new(lime__utils__AssetCache r0) {
	haxe__ds__StringMap r2;
	bool r1;
	int r4;
	r1 = true;
	r0->enabled = r1;
	r2 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r2);
	r0->audio = r2;
	r2 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r2);
	r0->font = r2;
	r2 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r2);
	r0->image = r2;
	r4 = 274723;
	r0->version = r4;
	return;
}

