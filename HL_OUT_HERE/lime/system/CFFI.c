// Generated by HLC 4.3.1 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <lime/system/CFFI.h>
#include <hl/types/ArrayDyn.h>
extern hl_type t$fun_ff5291f;
vdynamic* Reflect__makeVarArgs(vclosure*);
extern lime__system__$CFFI g$_lime_system_CFFI;
extern hl_type t$haxe_ds_StringMap;
void haxe_ds_StringMap_new(haxe__ds__StringMap);
void haxe_ds_StringMap_set(haxe__ds__StringMap,String,vdynamic*);
bool haxe_ds_StringMap_exists(haxe__ds__StringMap,String);
extern String s$0374ec8;
String String___add__(String,String);
vdynamic* lime_system_CFFI___tryLoad(String,String,String,int);
extern String s$d1e041f;
String lime_system_CFFI___sysName(void);
String String_substr(String,int,vdynamic*);
String String_toLowerCase(String);
extern String s$windows;
int String___compare(String,vdynamic*);
extern String s$28d397e;
extern String s$6666cd7;
extern String s$lime;
String lime_system_CFFI___findHaxelib(String);
extern String s$;
extern String s$ndll;
extern String s$64;
extern String s$Result_;
String Std_string(vdynamic*);
void lime_system_CFFI___loaderTrace(String);
#include <sys/io/Process.h>
#include <hl/types/ArrayObj.h>
#include <haxe/io/Input.h>
extern hl_type t$sys_io_Process;
extern String s$haxelib;
extern hl_type t$String;
#include <hl/natives.h>
extern String s$path;
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
void sys_io_Process_new(sys__io__Process,String,hl__types__ArrayObj,vdynamic*);
String haxe_io_Input_readLine(haxe__io__Input);
extern hl_type t$_i32;
extern String s$336d5eb;
void sys_io_Process_close(sys__io__Process);
extern String s$Found_haxelib_;
extern String s$OPENFL_LOAD_DEBUG;
String Sys_getEnv(String);
void Sys_println(vdynamic*);
String Sys_systemName(void);
extern String s$Got_result_;
extern String s$Failed_to_load_;

vdynamic* lime_system_CFFI_load__$1(hl__types__ArrayDyn r0) {
	vdynobj *r1;
	r1 = hl_alloc_dynobj();
	return ((vdynamic*)r1);
}

vdynamic* lime_system_CFFI_load(String r0,String r1,int* r2,bool* r3) {
	String r13, r14, r17, r20;
	haxe__ds__StringMap r11;
	bool r5, r6, r8;
	lime__system__$CFFI r12;
	vclosure *r10;
	vdynamic *r9, *r15, *r16, *r19;
	int r4, r18;
	static vclosure cl$0 = { &t$fun_ff5291f, lime_system_CFFI_load__$1, 0 };
	hl_trap_ctx trap$0;
	if( r2 ) goto label$6a388f2_2_3;
	r4 = 0;
	goto label$6a388f2_2_4;
	label$6a388f2_2_3:
	r4 = *r2;
	label$6a388f2_2_4:
	if( r3 ) goto label$6a388f2_2_7;
	r5 = false;
	goto label$6a388f2_2_8;
	label$6a388f2_2_7:
	r5 = *r3;
	label$6a388f2_2_8:
	r6 = false;
	if( r6 ) goto label$6a388f2_2_13;
	r10 = &cl$0;
	r9 = Reflect__makeVarArgs(r10);
	return r9;
	label$6a388f2_2_13:
	r9 = NULL;
	r12 = (lime__system__$CFFI)g$_lime_system_CFFI;
	r11 = r12->__moduleNames;
	if( r11 ) goto label$6a388f2_2_21;
	r11 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r11);
	r12 = (lime__system__$CFFI)g$_lime_system_CFFI;
	r12->__moduleNames = r11;
	label$6a388f2_2_21:
	if( !r5 ) goto label$6a388f2_2_31;
	r12 = (lime__system__$CFFI)g$_lime_system_CFFI;
	r11 = r12->__moduleNames;
	if( r11 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r11,r0,((vdynamic*)r0));
	hl_trap(trap$0,r15,label$6a388f2_2_29);
	hl_endtrap(trap$0);
	goto label$6a388f2_2_30;
	label$6a388f2_2_29:
	r16 = NULL;
	label$6a388f2_2_30:
	goto label$6a388f2_2_98;
	label$6a388f2_2_31:
	r12 = (lime__system__$CFFI)g$_lime_system_CFFI;
	r11 = r12->__moduleNames;
	if( r11 == NULL ) hl_null_access();
	r8 = haxe_ds_StringMap_exists(r11,r0);
	if( !r8 ) goto label$6a388f2_2_38;
	r15 = NULL;
	return r15;
	label$6a388f2_2_38:
	r12 = (lime__system__$CFFI)g$_lime_system_CFFI;
	r11 = r12->__moduleNames;
	if( r11 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r11,r0,((vdynamic*)r0));
	r13 = (String)s$0374ec8;
	r13 = String___add__(r13,r0);
	r15 = lime_system_CFFI___tryLoad(r13,r0,r1,r4);
	r9 = r15;
	if( r15 ) goto label$6a388f2_2_51;
	r13 = (String)s$d1e041f;
	r13 = String___add__(r13,r0);
	r15 = lime_system_CFFI___tryLoad(r13,r0,r1,r4);
	r9 = r15;
	label$6a388f2_2_51:
	if( r15 ) goto label$6a388f2_2_54;
	r15 = lime_system_CFFI___tryLoad(r0,r0,r1,r4);
	r9 = r15;
	label$6a388f2_2_54:
	if( r15 ) goto label$6a388f2_2_94;
	r13 = lime_system_CFFI___sysName();
	if( r13 == NULL ) hl_null_access();
	r18 = 7;
	r19 = NULL;
	r13 = String_substr(r13,r18,r19);
	if( r13 == NULL ) hl_null_access();
	r13 = String_toLowerCase(r13);
	r14 = (String)s$windows;
	if( r13 != r14 && (!r13 || !r14 || String___compare(r13,(vdynamic*)r14) != 0) ) goto label$6a388f2_2_66;
	r13 = (String)s$28d397e;
	goto label$6a388f2_2_67;
	label$6a388f2_2_66:
	r13 = (String)s$6666cd7;
	label$6a388f2_2_67:
	r14 = (String)s$lime;
	r14 = lime_system_CFFI___findHaxelib(r14);
	r20 = (String)s$;
	if( r14 == r20 || (r14 && r20 && String___compare(r14,(vdynamic*)r20) == 0) ) goto label$6a388f2_2_94;
	r17 = String___add__(r14,r13);
	r20 = (String)s$ndll;
	r17 = String___add__(r17,r20);
	r17 = String___add__(r17,r13);
	r20 = lime_system_CFFI___sysName();
	r17 = String___add__(r17,r20);
	r17 = String___add__(r17,r13);
	r17 = String___add__(r17,r0);
	r15 = lime_system_CFFI___tryLoad(r17,r0,r1,r4);
	r9 = r15;
	if( r15 ) goto label$6a388f2_2_94;
	r17 = String___add__(r14,r13);
	r20 = (String)s$ndll;
	r17 = String___add__(r17,r20);
	r17 = String___add__(r17,r13);
	r20 = lime_system_CFFI___sysName();
	r17 = String___add__(r17,r20);
	r20 = (String)s$64;
	r17 = String___add__(r17,r20);
	r17 = String___add__(r17,r13);
	r17 = String___add__(r17,r0);
	r15 = lime_system_CFFI___tryLoad(r17,r0,r1,r4);
	r9 = r15;
	label$6a388f2_2_94:
	r13 = (String)s$Result_;
	r14 = Std_string(r15);
	r13 = String___add__(r13,r14);
	lime_system_CFFI___loaderTrace(r13);
	label$6a388f2_2_98:
	return r9;
}

String lime_system_CFFI___findHaxelib(String r0) {
	String r4, r9, r15;
	sys__io__Process r3;
	hl__types__ArrayObj r5;
	hl_type *r7;
	bool r12;
	haxe__io__Input r11;
	vdynamic *r1, *r10, *r14, *r16;
	int r8, r13;
	varray *r6;
	hl_trap_ctx trap$0;
	hl_trap_ctx trap$1;
	hl_trap(trap$0,r1,label$6a388f2_3_48);
	r3 = (sys__io__Process)hl_alloc_obj(&t$sys_io_Process);
	r4 = (String)s$haxelib;
	r7 = &t$String;
	r8 = 2;
	r6 = hl_alloc_array(r7,r8);
	r9 = (String)s$path;
	r8 = 0;
	((String*)(r6 + 1))[r8] = r9;
	r8 = 1;
	((String*)(r6 + 1))[r8] = r0;
	r5 = hl_types_ArrayObj_alloc(r6);
	r10 = NULL;
	sys_io_Process_new(r3,r4,r5,r10);
	if( !r3 ) goto label$6a388f2_3_46;
	r11 = r3->stdout;
	hl_trap(trap$1,r1,label$6a388f2_3_41);
	label$6a388f2_3_17:
	r12 = true;
	if( !r12 ) goto label$6a388f2_3_39;
	if( r11 == NULL ) hl_null_access();
	r4 = haxe_io_Input_readLine(r11);
	if( r4 == NULL ) hl_null_access();
	r8 = 0;
	r13 = 1;
	r14 = hl_alloc_dynamic(&t$_i32);
	r14->v.i = r13;
	r9 = String_substr(r4,r8,r14);
	r15 = (String)s$336d5eb;
	if( r9 == r15 || (r9 && r15 && String___compare(r9,(vdynamic*)r15) == 0) ) goto label$6a388f2_3_38;
	((void (*)(haxe__io__Input))r11->$type->vobj_proto[2])(r11);
	if( r3 == NULL ) hl_null_access();
	sys_io_Process_close(r3);
	r9 = (String)s$Found_haxelib_;
	r9 = String___add__(r9,r4);
	lime_system_CFFI___loaderTrace(r9);
	hl_endtrap(trap$1);
	hl_endtrap(trap$1);
	return r4;
	label$6a388f2_3_38:
	goto label$6a388f2_3_17;
	label$6a388f2_3_39:
	hl_endtrap(trap$1);
	goto label$6a388f2_3_42;
	label$6a388f2_3_41:
	r16 = NULL;
	label$6a388f2_3_42:
	if( r11 == NULL ) hl_null_access();
	((void (*)(haxe__io__Input))r11->$type->vobj_proto[2])(r11);
	if( r3 == NULL ) hl_null_access();
	sys_io_Process_close(r3);
	label$6a388f2_3_46:
	hl_endtrap(trap$0);
	goto label$6a388f2_3_49;
	label$6a388f2_3_48:
	r16 = NULL;
	label$6a388f2_3_49:
	r4 = (String)s$;
	return r4;
}

void lime_system_CFFI___loaderTrace(String r0) {
	String r2, r3;
	bool r1;
	r2 = (String)s$OPENFL_LOAD_DEBUG;
	r2 = Sys_getEnv(r2);
	r3 = NULL;
	if( r2 != r3 && (!r2 || !r3 || String___compare(r2,(vdynamic*)r3) != 0) ) goto label$6a388f2_4_6;
	r1 = false;
	goto label$6a388f2_4_7;
	label$6a388f2_4_6:
	r1 = true;
	label$6a388f2_4_7:
	if( !r1 ) goto label$6a388f2_4_9;
	Sys_println(((vdynamic*)r0));
	label$6a388f2_4_9:
	return;
}

String lime_system_CFFI___sysName() {
	String r0;
	r0 = Sys_systemName();
	return r0;
}

vdynamic* lime_system_CFFI___tryLoad(String r0,String r1,String r2,int r3) {
	String r7;
	haxe__ds__StringMap r8;
	lime__system__$CFFI r9;
	vdynamic *r4, *r6;
	hl_trap_ctx trap$0;
	hl_trap(trap$0,r4,label$6a388f2_6_14);
	r4 = NULL;
	if( !r4 ) goto label$6a388f2_6_12;
	r7 = (String)s$Got_result_;
	r7 = String___add__(r7,r0);
	lime_system_CFFI___loaderTrace(r7);
	r9 = (lime__system__$CFFI)g$_lime_system_CFFI;
	r8 = r9->__moduleNames;
	if( r8 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r8,r1,((vdynamic*)r0));
	hl_endtrap(trap$0);
	return r4;
	label$6a388f2_6_12:
	hl_endtrap(trap$0);
	goto label$6a388f2_6_18;
	label$6a388f2_6_14:
	r6 = NULL;
	r7 = (String)s$Failed_to_load_;
	r7 = String___add__(r7,r0);
	lime_system_CFFI___loaderTrace(r7);
	label$6a388f2_6_18:
	r6 = NULL;
	return r6;
}

