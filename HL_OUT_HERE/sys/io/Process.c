// Generated by HLC 4.3.1 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <sys/io/Process.h>
#include <hl/types/ArrayObj.h>
#include <_std/StringBuf.h>
#include <hl/natives.h>
#include <_std/SysError.h>
#include <sys/io/_Process/Stdin.h>
#include <sys/io/_Process/Stdout.h>
extern sys__io__$Process g$_sys_io_Process;
extern hl_type t$StringBuf;
void StringBuf_new(StringBuf);
extern String s$COMSPEC;
String Sys_getEnv(String);
extern String s$cmd_exe;
extern String s$b15835f;
void StringBuf_add(StringBuf,vdynamic*);
extern String s$_C_;
void StringBuf_addChar(StringBuf,int);
extern String s$acd4ae9;
extern String s$3bd8640;
String StringBuf_toString(StringBuf);
extern hl_type t$_bytes;
vbyte* Sys_getPath(String);
extern hl_type t$SysError;
extern String s$Process_creation_failure_;
String String___add__(String,String);
void SysError_new(SysError,String);
extern hl_type t$sys_io__Process_Stdin;
void sys_io__Process_Stdin_new(sys__io___Process__Stdin,hl_process*);
extern hl_type t$sys_io__Process_Stdout;
void sys_io__Process_Stdout_new(sys__io___Process__Stdout,hl_process*,bool);

void sys_io_Process_new(sys__io__Process r0,String r1,hl__types__ArrayObj r2,vdynamic* r3) {
	String r4, r10, r11;
	SysError r29;
	hl__types__ArrayObj r9;
	sys__io___Process__Stdin r30;
	hl_type *r27;
	bool r6;
	sys__io___Process__Stdout r31;
	hl_process *r28;
	sys__io__$Process r7;
	StringBuf r8;
	vdynamic *r15;
	vbyte *r20;
	varray *r16, *r26;
	int r12, r13, r14, r17, r18, r19, r21, r22, r23, r24, r25;
	r4 = r1;
	r7 = (sys__io__$Process)g$_sys_io_Process;
	r6 = r7->isWin;
	if( !r6 ) goto label$397e5e6_1_108;
	r8 = (StringBuf)hl_alloc_obj(&t$StringBuf);
	StringBuf_new(r8);
	if( r2 ) goto label$397e5e6_1_21;
	r10 = (String)s$COMSPEC;
	r10 = Sys_getEnv(r10);
	if( r10 ) goto label$397e5e6_1_12;
	r11 = (String)s$cmd_exe;
	r10 = r11;
	label$397e5e6_1_12:
	r11 = (String)s$b15835f;
	StringBuf_add(r8,((vdynamic*)r11));
	StringBuf_add(r8,((vdynamic*)r10));
	r11 = (String)s$_C_;
	StringBuf_add(r8,((vdynamic*)r11));
	StringBuf_add(r8,((vdynamic*)r1));
	r12 = 34;
	StringBuf_addChar(r8,r12);
	goto label$397e5e6_1_105;
	label$397e5e6_1_21:
	r12 = 34;
	StringBuf_addChar(r8,r12);
	StringBuf_add(r8,((vdynamic*)r1));
	r12 = 34;
	StringBuf_addChar(r8,r12);
	r12 = 0;
	label$397e5e6_1_27:
	if( r2 == NULL ) hl_null_access();
	r14 = r2->length;
	if( r12 >= r14 ) goto label$397e5e6_1_103;
	r14 = r2->length;
	if( ((unsigned)r12) < ((unsigned)r14) ) goto label$397e5e6_1_35;
	r10 = NULL;
	goto label$397e5e6_1_38;
	label$397e5e6_1_35:
	r16 = r2->array;
	r15 = ((vdynamic**)(r16 + 1))[r12];
	r10 = (String)r15;
	label$397e5e6_1_38:
	++r12;
	if( r8 == NULL ) hl_null_access();
	r11 = (String)s$acd4ae9;
	StringBuf_add(r8,((vdynamic*)r11));
	r13 = 0;
	r14 = 0;
	if( r10 == NULL ) hl_null_access();
	r17 = r10->length;
	label$397e5e6_1_46:
	if( r14 >= r17 ) goto label$397e5e6_1_89;
	r18 = r14;
	++r14;
	if( r10 == NULL ) hl_null_access();
	r20 = r10->bytes;
	r21 = 1;
	r19 = r18 << r21;
	r19 = *(unsigned short*)(r20 + r19);
	switch(r19) {
		default:
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
		case 7:
		case 8:
		case 9:
		case 10:
		case 11:
		case 12:
		case 13:
		case 14:
		case 15:
		case 16:
		case 17:
		case 18:
		case 19:
		case 20:
		case 21:
		case 22:
		case 23:
		case 24:
		case 25:
		case 26:
		case 27:
		case 28:
		case 29:
		case 30:
		case 31:
		case 32:
		case 33:
		case 35:
		case 36:
		case 37:
		case 38:
		case 39:
		case 40:
		case 41:
		case 42:
		case 43:
		case 44:
		case 45:
		case 46:
		case 47:
		case 48:
		case 49:
		case 50:
		case 51:
		case 52:
		case 53:
		case 54:
		case 55:
		case 56:
		case 57:
		case 58:
		case 59:
		case 60:
		case 61:
		case 62:
		case 63:
		case 64:
		case 65:
		case 66:
		case 67:
		case 68:
		case 69:
		case 70:
		case 71:
		case 72:
		case 73:
		case 74:
		case 75:
		case 76:
		case 77:
		case 78:
		case 79:
		case 80:
		case 81:
		case 82:
		case 83:
		case 84:
		case 85:
		case 86:
		case 87:
		case 88:
		case 89:
		case 90:
		case 91:
			r21 = r19;
			r22 = 0;
			r23 = r13;
			label$397e5e6_1_59:
			if( r22 >= r23 ) goto label$397e5e6_1_66;
			++r22;
			if( r8 == NULL ) hl_null_access();
			r25 = 92;
			StringBuf_addChar(r8,r25);
			goto label$397e5e6_1_59;
			label$397e5e6_1_66:
			r22 = 0;
			r13 = r22;
			if( r8 == NULL ) hl_null_access();
			StringBuf_addChar(r8,r21);
			goto label$397e5e6_1_88;
		case 34:
			r21 = 0;
			r23 = 2;
			r22 = r13 * r23;
			label$397e5e6_1_74:
			if( r21 >= r22 ) goto label$397e5e6_1_81;
			++r21;
			if( r8 == NULL ) hl_null_access();
			r24 = 92;
			StringBuf_addChar(r8,r24);
			goto label$397e5e6_1_74;
			label$397e5e6_1_81:
			r21 = 0;
			r13 = r21;
			if( r8 == NULL ) hl_null_access();
			r11 = (String)s$3bd8640;
			StringBuf_add(r8,((vdynamic*)r11));
			goto label$397e5e6_1_88;
		case 92:
			++r13;
	}
	label$397e5e6_1_88:
	goto label$397e5e6_1_46;
	label$397e5e6_1_89:
	r14 = 0;
	r18 = 2;
	r17 = r13 * r18;
	label$397e5e6_1_92:
	if( r14 >= r17 ) goto label$397e5e6_1_99;
	++r14;
	if( r8 == NULL ) hl_null_access();
	r19 = 92;
	StringBuf_addChar(r8,r19);
	goto label$397e5e6_1_92;
	label$397e5e6_1_99:
	if( r8 == NULL ) hl_null_access();
	r14 = 34;
	StringBuf_addChar(r8,r14);
	goto label$397e5e6_1_27;
	label$397e5e6_1_103:
	r9 = NULL;
	r2 = r9;
	label$397e5e6_1_105:
	if( r8 == NULL ) hl_null_access();
	r10 = StringBuf_toString(r8);
	r4 = r10;
	label$397e5e6_1_108:
	r16 = NULL;
	if( !r2 ) goto label$397e5e6_1_132;
	if( r2 == NULL ) hl_null_access();
	r12 = r2->length;
	r27 = &t$_bytes;
	r26 = hl_alloc_array(r27,r12);
	r16 = r26;
	r13 = 0;
	r14 = r2->length;
	label$397e5e6_1_117:
	if( r13 >= r14 ) goto label$397e5e6_1_132;
	r17 = r13;
	++r13;
	if( r2 == NULL ) hl_null_access();
	r19 = r2->length;
	if( ((unsigned)r17) < ((unsigned)r19) ) goto label$397e5e6_1_126;
	r10 = NULL;
	goto label$397e5e6_1_129;
	label$397e5e6_1_126:
	r26 = r2->array;
	r15 = ((vdynamic**)(r26 + 1))[r17];
	r10 = (String)r15;
	label$397e5e6_1_129:
	r20 = Sys_getPath(r10);
	((vbyte**)(r16 + 1))[r17] = r20;
	goto label$397e5e6_1_117;
	label$397e5e6_1_132:
	r20 = Sys_getPath(r4);
	r6 = r3 ? r3->v.b : 0;
	r28 = hl_process_run(r20,r16,r6);
	r0->p = r28;
	r28 = r0->p;
	if( r28 ) goto label$397e5e6_1_143;
	r29 = (SysError)hl_alloc_obj(&t$SysError);
	r10 = (String)s$Process_creation_failure_;
	r10 = String___add__(r10,r1);
	SysError_new(r29,r10);
	hl_throw((vdynamic*)r29);
	label$397e5e6_1_143:
	r30 = (sys__io___Process__Stdin)hl_alloc_obj(&t$sys_io__Process_Stdin);
	r28 = r0->p;
	sys_io__Process_Stdin_new(r30,r28);
	r0->stdin = ((haxe__io__Output)r30);
	r31 = (sys__io___Process__Stdout)hl_alloc_obj(&t$sys_io__Process_Stdout);
	r28 = r0->p;
	r6 = true;
	sys_io__Process_Stdout_new(r31,r28,r6);
	r0->stdout = ((haxe__io__Input)r31);
	r31 = (sys__io___Process__Stdout)hl_alloc_obj(&t$sys_io__Process_Stdout);
	r28 = r0->p;
	r6 = false;
	sys_io__Process_Stdout_new(r31,r28,r6);
	r0->stderr = ((haxe__io__Input)r31);
	return;
}

void sys_io_Process_close(sys__io__Process r0) {
	hl_process *r2;
	r2 = r0->p;
	hl_process_close(r2);
	return;
}

