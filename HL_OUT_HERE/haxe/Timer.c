// Generated by HLC 4.3.1 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <haxe/Timer.h>
void haxe_Timer_run(haxe__Timer);
extern hl_type t$fun_66d087d;
extern haxe__$Timer g$_haxe_Timer;
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
double haxe_Timer_getMS(void);
void haxe_Timer_stop(haxe__Timer);
extern hl_type t$haxe_Timer;
extern hl_type t$ctx_fec7ba4;
extern hl_type t$fun_2322471;
int lime_system_System_getTimer(void);
#include <haxe/Log.h>
extern haxe__$Log g$_haxe_Log;
#include <hl/natives.h>
String String___alloc__(vbyte*,int);
extern String s$s;
String String___add__(String,String);
void hl_types_ArrayObj___expand(hl__types__ArrayObj,int);

void haxe_Timer_new(haxe__Timer r0,double r1) {
	hl__types__ArrayObj r5;
	bool r8;
	haxe__$Timer r6;
	double r3, r7;
	vclosure *r2;
	int r4;
	r2 = r0->run;
	if( r2 ) goto label$dcfb79f_1_4;
	r2 = hl_alloc_closure_ptr(&t$fun_66d087d,haxe_Timer_run,r0);
	r0->run = r2;
	label$dcfb79f_1_4:
	r0->mTime = r1;
	r6 = (haxe__$Timer)g$_haxe_Timer;
	r5 = r6->sRunningTimers;
	if( r5 == NULL ) hl_null_access();
	r4 = hl_types_ArrayObj_push(r5,((vdynamic*)r0));
	r3 = haxe_Timer_getMS();
	r7 = r0->mTime;
	r3 = r3 + r7;
	r0->mFireAt = r3;
	r8 = true;
	r0->mRunning = r8;
	return;
}

void haxe_Timer_delay__$1(venum* r0) {
	haxe__Timer r2;
	vclosure *r3;
	r2 = ((Enumt$ctx_fec7ba4*)r0)->p1;
	if( r2 == NULL ) hl_null_access();
	haxe_Timer_stop(r2);
	r3 = ((Enumt$ctx_fec7ba4*)r0)->p0;
	if( r3 == NULL ) hl_null_access();
	r3->hasValue ? ((void (*)(vdynamic*))r3->fun)((vdynamic*)r3->value) : ((void (*)(void))r3->fun)();
	return;
}

haxe__Timer haxe_Timer_delay(vclosure* r0,int r1) {
	venum *r6;
	haxe__Timer r2;
	vclosure *r5;
	double r3;
	r2 = (haxe__Timer)hl_alloc_obj(&t$haxe_Timer);
	r3 = (double)r1;
	haxe_Timer_new(r2,r3);
	r6 = hl_alloc_enum(&t$ctx_fec7ba4,0);
	((Enumt$ctx_fec7ba4*)r6)->p0 = (vclosure*)r0;
	((Enumt$ctx_fec7ba4*)r6)->p1 = (haxe__Timer)r2;
	r5 = hl_alloc_closure_ptr(&t$fun_2322471,haxe_Timer_delay__$1,r6);
	r2->run = r5;
	return r2;
}

double haxe_Timer_getMS() {
	double r1;
	int r0;
	r0 = lime_system_System_getTimer();
	r1 = (double)r0;
	return r1;
}

vdynamic* haxe_Timer_measure(vclosure* r0,vvirtual* r1) {
	String r11, r16;
	haxe__$Log r10;
	vclosure *r9;
	double r4, r7, r13;
	int *r14;
	vdynamic *r8;
	vbyte *r15;
	int r2, r5, r6, r12;
	r2 = lime_system_System_getTimer();
	r6 = 0;
	if( r6 >= r2 ) goto label$dcfb79f_5_7;
	r4 = (double)r2;
	r7 = 1000.;
	r4 = r4 / r7;
	goto label$dcfb79f_5_8;
	label$dcfb79f_5_7:
	r4 = 0.;
	label$dcfb79f_5_8:
	if( r0 == NULL ) hl_null_access();
	r8 = r0->hasValue ? ((vdynamic* (*)(vdynamic*))r0->fun)((vdynamic*)r0->value) : ((vdynamic* (*)(void))r0->fun)();
	r10 = (haxe__$Log)g$_haxe_Log;
	r9 = r10->trace;
	r5 = lime_system_System_getTimer();
	if( r9 == NULL ) hl_null_access();
	r6 = r5;
	r12 = 0;
	if( r12 >= r5 ) goto label$dcfb79f_5_22;
	r6 = r5;
	r7 = (double)r5;
	r13 = 1000.;
	r7 = r7 / r13;
	goto label$dcfb79f_5_23;
	label$dcfb79f_5_22:
	r7 = 0.;
	label$dcfb79f_5_23:
	r7 = r7 - r4;
	r14 = &r6;
	r15 = hl_ftos(r7,r14);
	r11 = String___alloc__(r15,r6);
	r16 = (String)s$s;
	r11 = String___add__(r11,r16);
	r9->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r9->fun)((vdynamic*)r9->value,((vdynamic*)r11),r1) : ((void (*)(vdynamic*,vvirtual*))r9->fun)(((vdynamic*)r11),r1);
	return r8;
}

void haxe_Timer_run(haxe__Timer r0) {
	return;
}

double haxe_Timer_stamp() {
	double r2, r3;
	int r0, r1;
	r0 = lime_system_System_getTimer();
	r1 = 0;
	if( r1 >= r0 ) goto label$dcfb79f_7_7;
	r2 = (double)r0;
	r3 = 1000.;
	r2 = r2 / r3;
	return r2;
	label$dcfb79f_7_7:
	r2 = 0.;
	return r2;
}

void haxe_Timer_stop(haxe__Timer r0) {
	hl__types__ArrayObj r5;
	bool r2;
	haxe__Timer r9;
	haxe__$Timer r6;
	vdynamic *r10;
	varray *r11;
	int r3, r4, r7, r8;
	r2 = r0->mRunning;
	if( !r2 ) goto label$dcfb79f_8_35;
	r2 = false;
	r0->mRunning = r2;
	r3 = 0;
	r6 = (haxe__$Timer)g$_haxe_Timer;
	r5 = r6->sRunningTimers;
	if( r5 == NULL ) hl_null_access();
	r4 = r5->length;
	label$dcfb79f_8_9:
	if( r3 >= r4 ) goto label$dcfb79f_8_35;
	r7 = r3;
	++r3;
	r6 = (haxe__$Timer)g$_haxe_Timer;
	r5 = r6->sRunningTimers;
	if( r5 == NULL ) hl_null_access();
	r8 = r5->length;
	if( ((unsigned)r7) < ((unsigned)r8) ) goto label$dcfb79f_8_20;
	r9 = NULL;
	goto label$dcfb79f_8_23;
	label$dcfb79f_8_20:
	r11 = r5->array;
	r10 = ((vdynamic**)(r11 + 1))[r7];
	r9 = (haxe__Timer)r10;
	label$dcfb79f_8_23:
	if( r9 != r0 ) goto label$dcfb79f_8_34;
	r6 = (haxe__$Timer)g$_haxe_Timer;
	r5 = r6->sRunningTimers;
	if( r5 == NULL ) hl_null_access();
	r9 = NULL;
	r8 = r5->length;
	if( ((unsigned)r7) < ((unsigned)r8) ) goto label$dcfb79f_8_31;
	hl_types_ArrayObj___expand(r5,r7);
	label$dcfb79f_8_31:
	r11 = r5->array;
	((haxe__Timer*)(r11 + 1))[r7] = r9;
	goto label$dcfb79f_8_35;
	label$dcfb79f_8_34:
	goto label$dcfb79f_8_9;
	label$dcfb79f_8_35:
	return;
}

void haxe_Timer___check(haxe__Timer r0,double r1) {
	vclosure *r5;
	double r3, r4;
	r4 = r0->mFireAt;
	if( !(r1 >= r4) ) goto label$dcfb79f_9_9;
	r3 = r0->mFireAt;
	r4 = r0->mTime;
	r3 = r3 + r4;
	r0->mFireAt = r3;
	r5 = r0->run;
	if( r5 == NULL ) hl_null_access();
	r5->hasValue ? ((void (*)(vdynamic*))r5->fun)((vdynamic*)r5->value) : ((void (*)(void))r5->fun)();
	label$dcfb79f_9_9:
	return;
}

